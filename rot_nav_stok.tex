\documentclass[a4paper,12pt]{article}
\usepackage{amsmath, amssymb, graphicx}
\graphicspath{ {D:/Education/ATMOCN_630/hw3/} }

\DeclareMathAlphabet{\mathcal}{OMS}{cmsy}{m}{n}
\SetMathAlphabet{\mathcal}{bold}{OMS}{cmsy}{b}{n}
\newcommand{\bigO}{\mathcal{O}}


\begin{document}

\title{\vspace{-4.0cm}Navier-Stokes Equations on a Rotating Sphere}
\author{Ian Beckley
\\University of Wisconsin-Madison}

\date{3 Dec. 2020}

\maketitle
Begin with the three dimensional Navier-Stokes equation in a fixed reference frame.

\begin{align}
\frac{d \vec V}{dt} = \vec g - \frac{1}{\rho}\nabla p + \upsilon \nabla^2 \vec V
\end{align}

Equation (1) states that the acceleration of the wind vector is caused by the gravitational acceleration, the pressure gradient force (alternatively, the height gradient force) and molecular viscosity. The representation of $\vec V$, however, depends on the reference frame of the observer. Seen from a distant star, winds on earth would appear to accelerate inward toward the axis of rotation. This conflict forces the further consideration of forces when $\vec V$ is seen from a rotating reference frame. 

We will show (with help from Holton and others), that the inward radial acceleration of the winds can be combined with gravity (they act in the same direction) into a single term, effective gravity. Additionally, the coriolis force, the torque acting upon the winds due to the rotation of the earth, yields four additional terms. Finally, six curvature terms are introduced via the acceleration of the unit vectors themselves (see Holton).

\subsection*{Rotational and Curvature Effects}

We begin by defining several necessary variables,

\begin{align*}
\vec x = \text{an arbitrary position vector relative to the center of the earth}\\
\vec r = \text{ a position vector relative to the rotation axis}\\
\vec \Omega = \text{ planetary vorticity vector, points toward Polaris}\\
\Omega = \frac{2\pi}{\tau_{day}} = 7.292 \times 10^{-5} \text{s}^{-1}\\
\vec \Omega \times \vec x = \vec \Omega \times \vec r = \Omega r = \text{ planetary azimuthal velocity}\\
\vec \Omega \times (\vec \Omega \times \vec r) = \Omega^{2} r
\end{align*}

$\vec{V} = \frac{d\vec{x}}{dt}$ is the velocity in a rotating frame while $\vec{V_f} = \frac{d_fx}{dt}$ is the velocity in a fixed frame.
For any vector $\vec{x}$,   $\frac{d_fx}{dt} = \frac{dx}{dt} + (\Omega \times \vec{X})$


therefor, 

\begin{align}
\frac{d_f\vec{V_f}}{dt} = \frac{d\vec{V_f}}{dt} + (\Omega \times \vec{X})\\
\frac{d}{dt}(\vec{V} + \Omega \times \vec{x}) + \Omega \times (\Omega \times \vec{x})\\
\frac{d\vec{V}}{dt} + 2\vec{\Omega} \times \vec{V} + (\Omega \times (\Omega \times \vec{x}))\\
\frac{d_f\vec{V_f}}{dt} = \frac{d\vec{V}}{dt} + 2\vec{\Omega} \times \vec{V} - \Omega^2\vec{r} = \sum{F_r}
\end{align}

or, in words, the time rate of change of the wind vector in a fixed reference frame is the sum of the Lagrangian (rotating) time rate of change in the wind vector, coriolis and centripital forces. Move the Lagrangian derivative to the LHS and isolate it while substituting the components of the fixed acceleration vector $\frac{d_f\vec{V_f}}{dt}$

\begin{align}
 \frac{d\vec{V}}{dt} = - 2\vec{\Omega} \times \vec{V} + \Omega^2\vec{r} + \vec{g} - \frac{1}{\rho}\nabla + \upsilon\nabla^2\vec{V}
\end{align}

or, in words, the Langrangian derivative of the wind vector is the sum of the coriolis, centripital, gravitational, pressure gradient, and viscous forces.

\subsubsection*{Effective gravity}
\begin{align}
\vec{g_{eff}} = \vec{g} + \Omega^2\vec{r} 
\end{align}

Take the gravitational potential and centripital potentials,

\begin{align}
\Phi_g = \frac{GM}{r} \text{ where } r = (a+z)\cos{\phi}\\
\Phi_c = \frac{\Omega^2r^2}{2}
\end{align}

since $\vec{g_{eff}} = \nabla \Phi$, and $\Phi_g + \Phi_c = \Phi$, it follows that

\begin{align}
\vec{g_{eff}} = -\frac{GM}{a^2}\hat{k} + \Omega a^2(-\cos\phi\sin\phi \, \hat{j} + \cos\phi\cos\phi \, \hat{k})
\end{align}

The first term on the LHS $\sim 10 \text{ m s}^{-1}$ while the second term on the LHS $\sim 10^{-2} \text{ m s}^{-1}$. For most atmospheric applications $\vec{g}$ departs from $\vec{g_{eff}}$ by $.3\%$ allowing negligence of the second term for most large-scale geophysical problems. 

The geoid departs from the sphere by $\frac{1}{300}$ such that the two poles are $\sim 21 \text{ km}$ closer to the center of the earth than the equator and experience a stronger vertical gravitational force. The second term on the RHS reveals that as $r$ increases the vertical centripital component increases, balancing the natural decrease in gravity which would be experienced at large $r$. This is why the Mississippi flows 'uphill'.

\subsubsection*{Coriolis force}
Recall from (6) that the coriolis force is given
\begin{align}
-2\Omega \times \vec{V} = -2\pi\begin{vmatrix} \hat{i} & \hat{j} & \hat{k} \\ - & \cos\phi & \sin\phi \\ u & v & w \end{vmatrix}\\
-2\Omega(w\cos\phi-v\sin\phi \hat{i} + u\sin\phi \hat{j} - ucos\phi\hat{k})
\end{align}

\subsubsection*{Curvature terms (Holton)}
In a rotating frame the unit vectors have a time dependence, thus

\begin{align}
\frac{\partial\vec{V}}{\partial t} = \frac{\partial u}{\partial t} \hat{i} + \frac{\partial v}{\partial t} \hat{j} + \frac{\partial w}{\partial t} \hat{k} + u\frac{\partial \hat{i}}{\partial t} + v\frac{\partial \hat{j}}{\partial t} + w\frac{\partial \hat{k}}{\partial t}
\end{align}

In spherical coordinates,

\begin{align}
\delta x = r\cos\phi \, \delta \lambda \\
\delta y = r \delta \phi\\
\delta z = \delta r
\end{align}

Converting to spherical coordinates,

\begin{align}
u = \frac{\partial x}{\partial t} = r\cos\phi\\
v = \frac{\partial y}{\partial t} = r\frac{\partial \phi}{\partial t}\\
w = \frac{\partial z}{\partial t} = \frac{\partial r}{\partial t}
\end{align}

Additionally, Holton shows

\begin{align}
\frac{\partial \hat{i}}{\partial t} = \frac{u}{a\cos\phi}(\hat{j}\sin\phi - \hat{k}\cos\phi)\\
\frac{\partial \hat{j}}{\partial t} = \frac{-u\tan\phi}{a} \hat{i} - \frac{v}{a} \hat{k}\\
\frac{\partial \hat{k}}{\partial t} = \frac{u}{a} \hat{i} + \frac{v}{a} \hat{j}
\end{align}

\subsection*{Expanded Form}
The equations of motion become,

\begin{align}
\frac{du}{dt} - uv\frac{\tan\phi}{a} + \frac{uw}{a} = -\frac{1}{\rho} \frac{\partial p}{\partial x} + 2\Omega v\sin\phi - 2\Omega w\cos\phi + \upsilon\nabla^2 u\\
\frac{dv}{dt} + u^2\frac{\tan\phi}{a} + \frac{vw}{a} = -\frac{1}{\rho} \frac{\partial p}{\partial y} - 2\Omega u \sin\phi + \upsilon\nabla^2 v\\
\frac{dw}{dt} - \frac{u^2 + v^2}{a} = -g - \frac{1}{\rho}\frac{\partial p}{\partial z} + 2\Omega u \cos\phi
\end{align}

\subsubsection*{Tangent Plane Approximation}

Take a plane tangent to the earth at some point. This can be thought of as transforming the equations of motion into Cartesian coordinates (we have already done this). This assumes the following relationships between coordinate systems.

\begin{align}
x = a\lambda \cos(\phi_0)\\
y = a(\phi-\phi_0)\\
z = z
\end{align}

Additionally, as we have done before, we will assume the three dimensional wind in Cartesian coordinates.

\begin{align}
\vec{V} = u\hat{i} + v\hat{j} + w\hat{k}
\end{align}

The so called 'metric terms' (those which arise from accelerating unit vectors) will be neglected.

Finally, we perform a Taylor series expansion on the scalar component of the Coriolis forcing, discarding higher order terms.

\begin{align}
2\Omega\sin(\phi) \approx 2\Omega\sin(\phi_0) + 2\Omega(\phi-\phi_0)\cos(\phi_0)
\end{align}

Taking $f = 2\Omega\sin(\phi)$ and $f_0 = 2\Omega\sin(\phi_0)$, we can also define $\beta = \frac{\partial f}{\partial y}$

\begin{align}
\beta = \frac{\partial f}{\partial y}\\
= 2\Omega\frac{\partial\sin(\frac{y}{a}+\phi_0)}{\partial y}\\
\beta = \frac{2\Omega\cos(\phi_0)}{a}
\end{align}

and re-write the Taylor series expansion, recalling that $\frac{y}{a} = (\phi-\phi_0)$

\begin{align}
f = f_0 + \beta y
\end{align}

The $f$ plane approximation neglects the $\beta$ term and assumes that the Coriolis forcing is constant. This is likely best suited for motions with relatively small meridional extent. Alternatively, the $\beta$-plane approximation retains both terms. Either way, the near zero acceleration of the vertical wind in an atmosphere in hydrostatic balance suggests that $|w| << |\vec{V_h}|$, and we can ignore the metric terms.

\subsubsection*{Boussinesq Approximation}

The Boussinesq approximation assumes that, to first order, $\nabla \rho \approx 0$. Ultimately, this allows for a simplifcation of the equations of motion such that we treat density as a constant except for minor instances of buoyancy (vertical). This is best suited for an incompressible fluid, wherein high pressure yields little to no change in the density of the fluid and pressure changes linearly with height. 
\begin{align}
\rho(x,y,z,t) \approx \rho_0 + \delta \rho(x,y,z,t)
\end{align}

Assuming that the fluid is in hydrostatic balance,

\begin{align}
\frac{\partial p_0}{\partial z} = -\rho_0 g
\end{align}

integrating $p$ leads to a similar representation of pressure.

\begin{align}
p(x,y,z,t) = p_0(z) + \delta p(x,y,z,t)
\end{align}

Recall that the gradient in rho was approximately zero. Similarly, we have assumed that horizontal fluctuations are small, albeit not always negligible. Differently, we assume that pressure has a vertical dependence, though we have yet to establish what that dependence is (linear, exponential, etc).

Beginning with the equation of motion on a tangent plane, we can subsequently expand $p$ and $\rho$. 

\begin{align}
\frac{d\vec{V}}{dt} +  f\hat{k} \times \vec{V} = -\frac{1}{\rho}\nabla p\\
(\rho_0 + \delta \rho) \left(\frac{d\vec{V}}{dt} +  f\hat{k} \times \vec{V}\right) = -\nabla \delta p - \frac{\partial p_0}{\partial z}\hat{k} - g(\rho_0 + \delta \rho)\hat{k}\\
(\rho_0 + \delta \rho) \left(\frac{d\vec{V}}{dt} +  f\hat{k} \times \vec{V}\right) = -\nabla \delta p + \rho_0 g\hat{k} - (\rho_0 - \delta \rho)g\hat{k}\\
(\rho_0 + \delta \rho) \left(\frac{d\vec{V}}{dt} +  f\hat{k} \times \vec{V}\right) = -\nabla \delta p - g\delta\rho\hat{k}
\end{align}

Assuming that $|\rho_0| >> |\delta\rho|$, we can neglect $\delta\rho$ on the LHS, reducing the above to 

\begin{align}
\frac{d\vec{V}}{dt} + 2\Omega \times \vec{V} = -\nabla \phi + b\hat{k}
\end{align}

where $\phi = \frac{\delta \rho}{\rho_0}$ and $b = -\frac{g\delta\rho}{\rho_0}$

We can also simplify the mass continuity equation as follows

\begin{align}
\boxed{\frac{d\delta\rho}{dt} + (\rho_0 +\delta\rho)\nabla \cdot \vec{V} = 0}
\end{align}

We assume that time scales advectively such that the time derivative can be neglected. Dividing density out, 

\begin{align}
\boxed{\nabla \cdot \vec{V} = 0}
\end{align}

See Vallis (2017) for further discussion and a more detailed approximation.


\subsubsection*{Hyrdostatic balance}
In the vertical, the coriolis force $\sim 10^{-3}$, the curvature term $\sim 10^{-5}$ and the viscous term $\sim 10^{-19}$. The vertical pressure gradient and gravitational forces, however, $\sim 10$. If there is no vertical acceleration the flow is said to be in \emph{hyrdostatic balance},

\begin{align}
\frac{dw}{dt} = 0 = -g - \frac{1}{\rho}\frac{\partial p}{\partial z}\\
g = -\frac{1}{\rho}\frac{\partial p}{\partial z}\\
\boxed{g\rho\partial z = -\partial p}
\end{align}

\subsubsection*{Geostrophic balance}
In the horizontal, curvature terms $\sim 10^{-5}$ and $10^{-7}$, respectively. The $\cos\phi$ coriolis forcing in the zonal momentum equation $\sim 10^{-6}$ and the viscous term $\sim 10^{-16}$. The pressure gradient force and $\sin\phi$ coriolis forcings, however, $\sim 10^{-3}$. If $\frac{du}{dt} = 0$ the flow is said to be in \emph{geostrophic balance}.
Define $ f = 2\Omega\sin\phi$,

\begin{align}
\frac{du}{dt} = 0 = -\frac{1}{\rho}\frac{\partial p}{\partial x}+ fv\\
\frac{1}{\rho}\frac{\partial p}{\partial x} = fv\\
\boxed{v = \frac{1}{f\rho}\frac{\partial p}{\partial x}}
\end{align}

\begin{align}
\frac{dv}{dt} = 0 = -\frac{1}{\rho}\frac{\partial p}{\partial y} - fu\\
-\frac{1}{\rho}\frac{\partial p}{\partial y} = fu\\
\boxed{u = -\frac{1}{f\rho}\frac{\partial p}{\partial y}}
\end{align}

\subsubsection*{Non-divergence of the geostrophic wind}
Further, the geostrophic stream function is defined $\psi_g = \frac{\delta p_{h}}{f\rho}$ such that

\begin{align}
u_g = -\frac{\partial\psi_g}{\partial y}\\
v_g = \frac{\partial\psi_g}{\partial x}
\end{align}

Taking the divergence of the wind vector,

\begin{align}
\nabla \cdot \vec{V_g} = \frac{\partial u_g}{\partial x} + \frac{\partial v_g}{\partial y}\\
= -\frac{\partial}{\partial x}\frac{\partial \psi_g}{\partial y} + \frac{\partial}{\partial y}\frac{\partial \psi_g}{\partial x}\\
= 0
\end{align}

Therefore

\begin{align}
\boxed{\nabla \cdot \vec{V_g} = 0}
\end{align}


\subsubsection*{Rossby number}

The Rossby number can be defined as the horizontal acceleration over the coriolis forcing, or

\begin{align}
\boxed{R_0 = \frac{|\frac{du}{dt}|}{fv} \sim \frac{U}{fL}}
\end{align}

On the synoptic scale $f \sim 10^-4$, $L \sim 10^6$ and $U \sim 10$ such that $R_0 << 1$. Under this criteria $\vec{V}$ is well approximated as $\vec{V_g}$. If $R \sim 1$ it should be clear that the pressure gradient force is dominating the coriolis force, and the geostrophic approximation should not be made.
\end{document}